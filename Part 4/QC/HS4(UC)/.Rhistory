ggplot(data = srobj_1@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
# Plot 2: nFeature_RNA vs MTpercent
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_1@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
head(rownames(srobj_1))
# Calculate mitochondrial percentage
srobj_1[["MTpercent"]] <- PercentageFeatureSet(srobj_1, pattern = "^MT")
# --- QC Plots ---
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS1(HC)")
# Plot 1: nCount_RNA vs MTpercent
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_1@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
# Plot 2: nFeature_RNA vs MTpercent
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_1@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
# Subset (filter) cells based on QC thresholds
srobj_1 <- subset(
srobj_1,
subset = nFeature_RNA > 800 &
nFeature_RNA < 1900 &
MTpercent < 15 &
nCount_RNA > 1500 &
nCount_RNA < 6000
)
# Show all gene names that start with 'MT' or 'mt'
mt_genes <- grep("^MT|^mt", rownames(srobj_1), value = TRUE)
# Print them
mt_genes
# Real mitochondrial genes in human
mt_real <- c("MT-ND1","MT-ND2","MT-ND3","MT-ND4","MT-ND4L","MT-ND5","MT-ND6",
"MT-CO1","MT-CO2","MT-CO3","MT-ATP6","MT-ATP8","MT-CYB","MT-RNR1","MT-RNR2")
# Subset your gene names to match only real ones
mt_genes_correct <- rownames(srobj_1)[rownames(srobj_1) %in% mt_real]
library(Seurat)
library(ggplot2)
# Pick first sample (you can change to any other, e.g., "HS10")
HS2 <- sample_list[["HS2"]]
# Extract expression and metadata
CountMatrix <- t(HS2$expression)   # transpose for Seurat (genes as rows)
metadata <- HS2$metadata
# Pick first sample (you can change to any other, e.g., "HS10")
HS2 <- sample_list[["HS2"]]
# Extract expression and metadata
CountMatrix <- t(HS2$expression)   # transpose for Seurat (genes as rows)
metadata <- HS2$metadata
# Create Seurat object
srobj_2 <- CreateSeuratObject(
counts = CountMatrix,
project = "HS2",
min.cells = 3,
min.features = 200,
meta.data = metadata
)
# Calculate mitochondrial percentage
srobj_2[["MTpercent"]] <- PercentageFeatureSet(srobj_2, pattern = "^MT")
# --- QC Plots ---
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS2(HC)")
# Plot 1: nCount_RNA vs MTpercent
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_2@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
# Plot 2: nFeature_RNA vs MTpercent
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_2@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
library(Seurat)
library(ggplot2)
# Pick first sample (you can change to any other, e.g., "HS10")
HS14 <- sample_list[["HS14"]]
# Extract expression and metadata
CountMatrix <- t(HS14$expression)   # transpose for Seurat (genes as rows)
metadata <- H14$metadata
library(Seurat)
library(ggplot2)
# Pick first sample (you can change to any other, e.g., "HS10")
HS14 <- sample_list[["HS14"]]
CountMatrix <- t(HS14$expression)   # transpose for Seurat (genes as rows)
metadata <- H14$metadata
metadata <- Hs14$metadata
metadata <- HS14$metadata
# Create Seurat object
srobj_2 <- CreateSeuratObject(
counts = CountMatrix,
project = "HS14",
min.cells = 3,
min.features = 200,
meta.data = metadata
)
# Calculate mitochondrial percentage
srobj_2[["MTpercent"]] <- PercentageFeatureSet(srobj_2, pattern = "^MT")
# --- QC Plots ---
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS14(CPI_colitis)")
# Plot 1: nCount_RNA vs MTpercent
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_2@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
# Plot 2: nFeature_RNA vs MTpercent
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_2@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
library(Seurat)
library(ggplot2)
# Pick first sample (you can change to any other, e.g., "HS10")
HS1 <- sample_list[["HS1"]]
# Extract expression and metadata
CountMatrix <- t(HS1$expression)   # transpose for Seurat (genes as rows)
metadata <- HS1$metadata
# Create Seurat object
srobj_1 <- CreateSeuratObject(
counts = CountMatrix,
project = "HS1",
min.cells = 3,
min.features = 200,
meta.data = metadata
)
# Calculate mitochondrial percentage
srobj_1[["MTpercent"]] <- PercentageFeatureSet(srobj_1, pattern = "^MT.")
# --- QC Plots ---
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS1(HC)")
# Plot 1: nCount_RNA vs MTpercent
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_1@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
# Plot 2: nFeature_RNA vs MTpercent
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_1@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
library(Seurat)
library(ggplot2)
# Pick first sample (you can change to any other, e.g., "HS10")
HS14 <- sample_list[["HS14"]]
# Extract expression and metadata
CountMatrix <- t(HS14$expression)   # transpose for Seurat (genes as rows)
metadata <- HS14$metadata
# Create Seurat object
srobj_2 <- CreateSeuratObject(
counts = CountMatrix,
project = "HS14",
min.cells = 3,
min.features = 200,
meta.data = metadata
)
# Calculate mitochondrial percentage
srobj_2[["MTpercent"]] <- PercentageFeatureSet(srobj_2, pattern = "^MT.")
# --- QC Plots ---
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS14(CPI_colitis)")
# Plot 1: nCount_RNA vs MTpercent
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_2@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
# Plot 2: nFeature_RNA vs MTpercent
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_2@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
HS1 <- sample_list[["HS1"]]
# Extract expression and metadata
CountMatrix <- t(HS1$expression)
# Create Seurat object
srobj_1 <- CreateSeuratObject(counts = CountMatrix, project = "Jun_HS1_HC", min.cells = 3, min.features = 200)
srobj_1[["MTpercent"]] <- PercentageFeatureSet(srobj_1, pattern = "^MT\\.")
# --- QC Plots ---
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS1(HC)")
# Plot 1: nCount_RNA vs MTpercent
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_1@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
# Plot 2: nFeature_RNA vs MTpercent
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = srobj_1@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
# Subset (filter) cells based on QC thresholds
srobj_1 <- subset(srobj_1, subset = nFeature_RNA > 800 & nFeature_RNA < 1900 & MTpercent < 15 & nCount_RNA > 1500 & nCount_RNA < 6000)
################################################################################ Start libraries
library(Seurat)
library(ggplot2)
################################################################################ End libraries
################################################################################ Start reading the expression and metadata CSVs, and splitting the data by each patient.
# Expression matrix
expr <- read.csv("C:/Esmaeil/irAEsProject/Backup/Part 4/Data/1_Python Data Preparation/expression.csv", row.names = 1)
# Metadata file
obs <- read.csv("C:/Esmaeil/irAEsProject/Backup/Part 4/Data/1_Python Data Preparation/metadata_obs.csv", row.names = 1)
# Look at the column names to find the group info
colnames(obs)
# Check if rownames match
all(rownames(expr) == rownames(obs))
# Convert to character if needed
obs$CoLabs_patient <- as.character(obs$CoLabs_patient)
setwd("C:/Esmaeil/irAEsProject/Backup/Part 4/Data/2_RDS before QC")
# Keep results in memory
sample_list <- list()
for (s in samples) {
cells <- rownames(obs)[obs$CoLabs_patient == s]
expr_subset <- expr[cells, , drop = FALSE]
obs_subset  <- obs[cells, , drop = FALSE]
sample_data <- list(expression = expr_subset, metadata = obs_subset)
# Save to RDS
saveRDS(sample_data, file = paste0(output_dir, s, ".rds"))
# Keep in R environment
sample_list[[s]] <- sample_data
cat("Saved and stored:", s, "(", nrow(expr_subset), "cells, disease:",
unique(obs_subset$disease), ")\n")
}
# Unique samples (based on our data)
samples <- c("HS1","HS2","HS3","HS4","HS5","HS7","HS8","HS9", "HS10","HS11","HS12","HS13","HS14","HS15")
for (s in samples) {
cells <- rownames(obs)[obs$CoLabs_patient == s]
expr_subset <- expr[cells, , drop = FALSE]
obs_subset  <- obs[cells, , drop = FALSE]
sample_data <- list(expression = expr_subset, metadata = obs_subset)
# Save to RDS
saveRDS(sample_data, file = paste0(output_dir, s, ".rds"))
# Keep in R environment
sample_list[[s]] <- sample_data
cat("Saved and stored:", s, "(", nrow(expr_subset), "cells, disease:",
unique(obs_subset$disease), ")\n")
}
for (s in samples) {
cells <- rownames(obs)[obs$CoLabs_patient == s]
expr_subset <- expr[cells, , drop = FALSE]
obs_subset  <- obs[cells, , drop = FALSE]
sample_data <- list(expression = expr_subset, metadata = obs_subset)
# Save to RDS
saveRDS(sample_data, file = "paste0(C:/Esmaeil/irAEsProject/Backup/Part 4/Data/2_RDS before QC")
# Keep in R environment
sample_list[[s]] <- sample_data
cat("Saved and stored:", s, "(", nrow(expr_subset), "cells, disease:",
unique(obs_subset$disease), ")\n")
}
# Keep results in memory
sample_list <- list()
for (s in samples) {
cells <- rownames(obs)[obs$CoLabs_patient == s]
expr_subset <- expr[cells, , drop = FALSE]
obs_subset  <- obs[cells, , drop = FALSE]
sample_data <- list(expression = expr_subset, metadata = obs_subset)
sample_list[[s]] <- sample_data
cat("Saved and stored:", s, "(", nrow(expr_subset), "cells, disease:",
unique(obs_subset$disease), ")\n")
}
################################################################################ Start HS1(HC)
HS1 <- sample_list[["HS1"]]
CountMatrix <- t(HS1$expression)
Jun_srobj_1 <- CreateSeuratObject(counts = CountMatrix, project = "Jun_HS1_HC", min.cells = 3, min.features = 200)
Jun_srobj_1[["MTpercent"]] <- PercentageFeatureSet(Jun_srobj_1, pattern = "^MT\\.")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS1(HC)")
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_1@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 1500, color = 'red') +
geom_vline(xintercept = 6000, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_1@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 15, color = 'red') +
geom_vline(xintercept = 800, color = 'red') +
geom_vline(xintercept = 1900, color = 'red')
dev.off()
Jun_srobj_1 <- subset(Jun_srobj_1, subset = nFeature_RNA > 800 & nFeature_RNA < 1900 & MTpercent < 15 & nCount_RNA > 1500 & nCount_RNA < 6000)
################################################################################ End HS1(HC)
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS1(HC)")
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_1@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 3500, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_1@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 650, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
HS1 <- sample_list[["HS1"]]
CountMatrix <- t(HS1$expression)
Jun_srobj_1 <- CreateSeuratObject(counts = CountMatrix, project = "Jun_HS1_HC", min.cells = 3, min.features = 200)
Jun_srobj_1[["MTpercent"]] <- PercentageFeatureSet(Jun_srobj_1, pattern = "^MT\\.")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS1(HC)")
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_1@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 3500, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_1@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 650, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
Jun_srobj_1 <- subset(Jun_srobj_1, subset = nFeature_RNA > 650 & nFeature_RNA < 3000 & MTpercent < 5 & nCount_RNA > 1000 & nCount_RNA < 3500)
HS2 <- sample_list[["HS2"]]
CountMatrix <- t(HS2$expression)
Jun_srobj_2 <- CreateSeuratObject(counts = CountMatrix, project = "Jun_HS2_HC", min.cells = 3, min.features = 200)
Jun_srobj_2[["MTpercent"]] <- PercentageFeatureSet(Jun_srobj_2, pattern = "^MT\\.")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS2(HC)")
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_2@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 3500, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_2@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 650, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
Jun_srobj_2 <- subset(Jun_srobj_2, subset = nFeature_RNA > 650 & nFeature_RNA < 3000 & MTpercent < 5 & nCount_RNA > 1000 & nCount_RNA < 3500)
HS3 <- sample_list[["HS3"]]
CountMatrix <- t(HS3$expression)
Jun_srobj_3 <- CreateSeuratObject(counts = CountMatrix, project = "Jun_HS3_HC", min.cells = 3, min.features = 200)
Jun_srobj_3[["MTpercent"]] <- PercentageFeatureSet(Jun_srobj_3, pattern = "^MT\\.")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS3(HC)")
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_3@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 3500, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_3@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 650, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
Jun_srobj_3 <- subset(Jun_srobj_3, subset = nFeature_RNA > 650 & nFeature_RNA < 3000 & MTpercent < 5 & nCount_RNA > 1000 & nCount_RNA < 3500)
################################################################################ Start HS4(UC)
HS4 <- sample_list[["HS4"]]
CountMatrix <- t(HS4$expression)
Jun_srobj_4 <- CreateSeuratObject(counts = CountMatrix, project = "Jun_HS4_UC", min.cells = 3, min.features = 200)
Jun_srobj_4[["MTpercent"]] <- PercentageFeatureSet(Jun_srobj_4, pattern = "^MT\\.")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS4(UC)")
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_4@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 3500, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_4@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 650, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
Jun_srobj_4 <- subset(Jun_srobj_4, subset = nFeature_RNA > 650 & nFeature_RNA < 3000 & MTpercent < 5 & nCount_RNA > 1000 & nCount_RNA < 3500)
################################################################################ End HS4(UC)
HS4 <- sample_list[["HS4"]]
CountMatrix <- t(HS4$expression)
Jun_srobj_4 <- CreateSeuratObject(counts = CountMatrix, project = "Jun_HS4_UC", min.cells = 3, min.features = 200)
Jun_srobj_4[["MTpercent"]] <- PercentageFeatureSet(Jun_srobj_4, pattern = "^MT\\.")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 4/QC/HS4(UC)")
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_4@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 3500, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_4@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 650, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
png(filename = "1.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_4@meta.data, aes(x = nCount_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
png(filename = "2.png", width = 10000, height = 4000, units = "px", res = 600)
ggplot(data = Jun_srobj_4@meta.data, aes(x = nFeature_RNA, y = MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nFeature_RNA', y = 'Percent Mito') +
scale_x_log10() +
geom_hline(yintercept = 5, color = 'red') +
geom_vline(xintercept = 650, color = 'red') +
geom_vline(xintercept = 3000, color = 'red')
dev.off()
Jun_srobj_4 <- subset(Jun_srobj_4, subset = nFeature_RNA > 650 & nFeature_RNA < 3000 & MTpercent < 5 & nCount_RNA > 1000 & nCount_RNA < 3500)
