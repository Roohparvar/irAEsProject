setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4")
library(Seurat)
library(SeuratObject)
library(ggplot2)
setwd("C:/Esmaeil/irAEsProject/Backup/Part4/P1_T")
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_T")
srobj_1=CreateSeuratObject(CountMatrix,project ="P1_T_Blood",min.cells=3,min.features=200)
srobj_1[["MTpercent"]]=PercentageFeatureSet(srobj_1,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_1@meta.data, aes(x = srobj_1$nCount_RNA, y = srobj_1$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 25, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 25000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_1@meta.data, aes(x=srobj_1$nFeature_RNA, y=srobj_1$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=25, color='red') +
geom_vline(xintercept=600, color='red') +
geom_vline(xintercept=5000, color='red')
dev.off()
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_1@meta.data, aes(x = srobj_1$nCount_RNA, y = srobj_1$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 30, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_1@meta.data, aes(x=srobj_1$nFeature_RNA, y=srobj_1$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=30, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_1@meta.data, aes(x = srobj_1$nCount_RNA, y = srobj_1$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 40, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_1@meta.data, aes(x=srobj_1$nFeature_RNA, y=srobj_1$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=40, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
srobj_1=subset(srobj_1,subset=nFeature_RNA>500 & nFeature_RNA<4000 & MTpercent<40 & nCount_RNA>1000 & nCount_RNA<22000)
srobj_P1_T=subset(srobj_1,subset=nFeature_RNA>500 & nFeature_RNA<4000 & MTpercent<40 & nCount_RNA>1000 & nCount_RNA<22000)
setwd("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
srobj_1=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
setwd("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
################################################################################ Start library
library(Seurat)
library(SeuratObject)
library(ggplot2)
################################################################################ End library
################################################################################ Start P1_T #1
setwd("C:/Esmaeil/irAEsProject/Backup/Part4/P1_T")
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_T")
srobj_1=CreateSeuratObject(CountMatrix,project ="P1_T_Blood",min.cells=3,min.features=200)
srobj_1[["MTpercent"]]=PercentageFeatureSet(srobj_1,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_1@meta.data, aes(x = srobj_1$nCount_RNA, y = srobj_1$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 40, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_1@meta.data, aes(x=srobj_1$nFeature_RNA, y=srobj_1$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=40, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
srobj_P1_T=subset(srobj_1,subset=nFeature_RNA>500 & nFeature_RNA<4000 & MTpercent<40 & nCount_RNA>1000 & nCount_RNA<22000)
################################################################################ End P1_T #1
################################################################################ Start P1_TN #1
setwd("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
srobj_2=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
################################################################################ Start library
library(Seurat)
library(SeuratObject)
library(ggplot2)
################################################################################ End library
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_T")
srobj=CreateSeuratObject(CountMatrix,project ="P1_T_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P1_T")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 40, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=40, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
srobj_P1_T=subset(srobj,subset=nFeature_RNA>500 & nFeature_RNA<4000 & MTpercent<40 & nCount_RNA>1000 & nCount_RNA<22000)
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
rownames(CountMatrix) <- make.unique(rownames(CountMatrix))
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
any(duplicated(rownames(CountMatrix)))
sum(duplicated(rownames(CountMatrix)))
class(CountMatrix)
any(duplicated(colnames(CountMatrix)))
sum(duplicated(colnames(CountMatrix)))\
sum(duplicated(colnames(CountMatrix)))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
sum(duplicated(colnames(CountMatrix)))\
sum(duplicated(colnames(CountMatrix)))\
sum(duplicated(colnames(CountMatrix)))
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P1_TN")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 40, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=40, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 2, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=2, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P1_TN")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 1, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=1, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
nrow(CountMatrix)
ncol(CountMatrix)
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
rownames(CountMatrix) <- make.unique(rownames(CountMatrix))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
################################################################################ Start P1_TN #1
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P1_TN")
rownames(CountMatrix) <- make.unique(rownames(CountMatrix))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
rownames(CountMatrix) <- gsub("_", "-", rownames(CountMatrix))
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
View(srobj)
View(srobj)
unique(srobj@meta.data[["MTpercent"]])
summary(srobj[["MTpercent"]])
head(rownames(srobj))
mt_genes <- c("ENSG00000198888", "ENSG00000198763", "ENSG00000198804", ...)
mt_genes <- c("ENSG00000198888", "ENSG00000198763", "ENSG00000198804")
srobj[["percent.mt"]] <- PercentageFeatureSet(srobj, features = mt_genes)
summary(srobj[["percent.mt"]])
a = unique(rownames(srobj))
install.packages("scCustomize")
# Load the package
library(scCustomize)
# Access the list of human mitochondrial Ensembl gene IDs
mt_genes <- ensembl_mito_id$Homo_sapiens_mito_ensembl
# Print the first few entries to verify
head(mt_genes)
mt_genes <- c("ENSG00000210049" "ENSG00000211459" "ENSG00000210077" "ENSG00000210082" "ENSG00000209082" "ENSG00000198888")
mt_genes <- c("ENSG00000210049", "ENSG00000211459", "ENSG00000210077", "ENSG00000210082", "ENSG00000209082", "ENSG00000198888")
srobj[["percent.mt"]] <- PercentageFeatureSet(srobj, features = mt_genes)
summary(srobj[["percent.mt"]])
mt_genes_present <- mt_genes[mt_genes %in% rownames(srobj)]
mt_genes_present
length(mt_genes_present)
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P2_TN")
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
rownames(CountMatrix) <- make.unique(rownames(CountMatrix))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
rownames(CountMatrix) <- gsub("_", "-", rownames(CountMatrix))
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P2_TN")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 1, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=1, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P3_TN")
################################################################################ Start P1_TN #2
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P3_TN")
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
rownames(CountMatrix) <- make.unique(rownames(CountMatrix))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
rownames(CountMatrix) <- gsub("_", "-", rownames(CountMatrix))
srobj=CreateSeuratObject(CountMatrix,project ="P1_TN_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P3_TN")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 1, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=1, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P20_TN")
srobj=CreateSeuratObject(CountMatrix,project ="P29_TN_Blood",min.cells=3,min.features=200)
rownames(CountMatrix) <- make.unique(rownames(CountMatrix))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
rownames(CountMatrix) <- gsub("_", "-", rownames(CountMatrix))
srobj=CreateSeuratObject(CountMatrix,project ="P29_TN_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P20_TN")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 1, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=1, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P20_T")
srobj=CreateSeuratObject(CountMatrix,project ="P20_T_Blood",min.cells=3,min.features=200)
rownames(CountMatrix) <- make.unique(rownames(CountMatrix))
colnames(CountMatrix) <- make.unique(colnames(CountMatrix))
rownames(CountMatrix) <- gsub("_", "-", rownames(CountMatrix))
srobj=CreateSeuratObject(CountMatrix,project ="P20_T_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P20_T")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 1, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=1, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
CountMatrix=Read10X("C:/Esmaeil/irAEsProject/Backup/Part4/P6_T")
srobj=CreateSeuratObject(CountMatrix,project ="P6_T_Blood",min.cells=3,min.features=200)
srobj[["MTpercent"]]=PercentageFeatureSet(srobj,pattern = "^MT-")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P6_T")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 1, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=1, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
head(rownames(srobj))
View(srobj)
> mt_genes <- c("ENSG00000210049", "ENSG00000211459", "ENSG00000210077", "ENSG00000210082", "ENSG00000209082", "ENSG00000198888") > srobj[["percent.mt"]] <- PercentageFeatureSet(srobj, features = mt_genes)
mt_genes <- c("ENSG00000210049", "ENSG00000211459", "ENSG00000210077", "ENSG00000210082", "ENSG00000209082", "ENSG00000198888") > srobj[["percent.mt"]] <- PercentageFeatureSet(srobj, features = mt_genes)
mt_genes <- c("ENSG00000210049", "ENSG00000211459", "ENSG00000210077", "ENSG00000210082", "ENSG00000209082", "ENSG00000198888")
srobj[["percent.mt"]] <- PercentageFeatureSet(srobj, features = mt_genes)
summary(srobj[["percent.mt"]])
install.packages("scCustomize")
# Load the package
library(scCustomize)
# Access the list of human mitochondrial Ensembl gene IDs
mt_genes <- ensembl_mito_id$Homo_sapiens_mito_ensembl
# Print the first few entries to verify
head(mt_genes)
srobj[["percent.mt"]] <- PercentageFeatureSet(srobj, features = mt_genes)
library(Seurat)
library(SeuratObject)
library(ggplot2)
srobj[["percent.mt"]] <- PercentageFeatureSet(srobj, features = mt_genes)
summary(srobj[["percent.mt"]])
srobj[["MTpercent"]] <- PercentageFeatureSet(srobj, features = mt_genes)
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4/Quality Control/P6_T")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj@meta.data, aes(x = srobj$nCount_RNA, y = srobj$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 1, color = 'red') +
geom_vline(xintercept = 1000, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj@meta.data, aes(x=srobj$nFeature_RNA, y=srobj$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=1, color='red') +
geom_vline(xintercept=500, color='red') +
geom_vline(xintercept=4000, color='red')
dev.off()
nrow(CountMatrix)
ncol(CountMatrix)
mt_genes
