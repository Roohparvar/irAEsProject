png(filename = "UMAP1.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
png(filename = "FeaturePlot.png", width = 10000, height = 4000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD78A"))
dev.off()
# Remove clusters 1 2 3 6 8 9 10
merged_obj1 <- subset(merged_obj1, subset = seurat_clusters %in% c(1,2,3,6,8,9,10), invert = TRUE)
png(filename = "UMAP2.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# Remove clusters 1 2 3 6 8 9 10
merged_obj1 <- subset(merged_obj1, subset = seurat_clusters %in% c(1,2,3,6,8,9,10), invert = TRUE)
png(filename = "UMAP2.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# Remove cells with an x-axis value less than -2.
umap_data <- Embeddings(merged_obj1, reduction = "integrated.cca")
cells_to_keep <- rownames(umap_data[umap_data[, "integrated.cca_1"] >= -2, ])
View(merged_obj1)
merged_obj1@reductions[["umap"]]@cell.embeddings
merged_obj1@reductions[["umap"]]@cell.embeddings
umap_coord = \merged_obj1@reductions[["umap"]]@cell.embeddings
umap_coord = merged_obj1@reductions[["umap"]]@cell.embeddings
View(umap_coord)
View(umap_coord)
merged_obj1 = LoadSeuratRds(file="C:/Esmaeil/scRNA-seq/Backup of Local Data and Files Not on GitHub/Part 2/3_The Seurat object obtained after FindNeighbors and FindClusters/merged_obj1")
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "UMAP1.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
png(filename = "FeaturePlot.png", width = 10000, height = 4000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD78A"))
dev.off()
# Remove clusters 1 2 3 6 8 9 10
merged_obj1 <- subset(merged_obj1, subset = seurat_clusters %in% c(1,2,3,6,8,9,10), invert = TRUE)
png(filename = "UMAP2.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
umap_coord <- merged_obj1@reductions[["umap"]]@cell.embeddings
View(umap_coord)
cells_to_keep <- rownames(umap_coord[umap_coord[, "UMAP_1"] >= -2, ])
colnames(umap_coord)
cells_to_keep <- rownames(umap_coord[umap_coord[, "umap_1"] >= -2, ])
merged_obj1 <- subset(merged_obj1, cells = cells_to_keep)
png(filename = "UMAP3.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
desired_order <- c("0", "1", "2", "3", "4")
Idents(merged_obj1) <- factor(Idents(merged_obj1), levels = desired_order)
png(filename = "UMAP6.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# This code reorders the cluster identities in the Seurat object (merged_obj1) according to the specified order ("0", "1", "2", "3")
desired_order <- c("0", "1", "2", "3")
Idents(merged_obj1) <- factor(Idents(merged_obj1), levels = desired_order)
png(filename = "UMAP4.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
merged_obj1 = LoadSeuratRds(file="C:/Esmaeil/scRNA-seq/Backup of Local Data and Files Not on GitHub/Part 2/3_The Seurat object obtained after FindNeighbors and FindClusters/merged_obj1")
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "UMAP1.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
png(filename = "FeaturePlot.png", width = 10000, height = 4000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD78A"))
dev.off()
# Remove clusters 1 2 3 6 8 9 10
merged_obj1 <- subset(merged_obj1, subset = seurat_clusters %in% c(1,2,3,6,8,9,10), invert = TRUE)
png(filename = "UMAP2.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# Remove cells with an x-axis value less than -2.
umap_coord <- merged_obj1@reductions[["umap"]]@cell.embeddings
cells_to_keep <- rownames(umap_coord[umap_coord[, "umap_1"] >= -2, ])
merged_obj1 <- subset(merged_obj1, cells = cells_to_keep)
png(filename = "UMAP3.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
# This code reorders the cluster identities in the Seurat object (merged_obj1) according to the specified order ("0", "1", "2", "3")
desired_order <- c("0", "1", "2", "3")
Idents(merged_obj1) <- factor(Idents(merged_obj1), levels = desired_order)
png(filename = "UMAP4.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# 4
saveRDS(file = "merged_obj1",merged_obj1)
merged_obj2 = merged_obj1
# نمایش تعداد سمپل‌ها (یعنی unique values در orig.ident)
table(merged_obj2$orig.ident)
# یا فقط لیست سمپل‌ها:
unique(merged_obj2$orig.ident)
# یا فقط تعداد سمپل‌ها:
length(unique(merged_obj2$orig.ident))
samples <- unique(merged_obj2$sample_id)
colnames(merged_obj2@meta.data)
samples <- unique(merged_obj2$orig.ident)
# Looping through each sample and creating a separate Seurat object for each
for (i in seq_along(samples)) {
sample_name <- samples[i]
seurat_obj <- subset(merged_obj2, subset = orig.ident == sample_name)
assign(paste0("seurat_obj_", i), seurat_obj)
}
seurat_objs <- list(seurat_obj_1, seurat_obj_2, seurat_obj_3, seurat_obj_4, seurat_obj_5,
seurat_obj_6, seurat_obj_7, seurat_obj_8, seurat_obj_9, seurat_obj_10,
seurat_obj_11, seurat_obj_12, seurat_obj_13, seurat_obj_14, seurat_obj_15,
seurat_obj_16, seurat_obj_17, seurat_obj_18, seurat_obj_19, seurat_obj_20,
seurat_obj_21, seurat_obj_22, seurat_obj_23, seurat_obj_24, seurat_obj_25,
seurat_obj_26, seurat_obj_27, seurat_obj_28, seurat_obj_29, seurat_obj_30)
# Loop to save each Seurat object
for (i in 1:length(seurat_objs)) {
saveRDS(seurat_objs[[i]], file = paste0("seurat_obj_", i, ".rds"))
}
merged_obj2 <- JoinLayers(merged_obj2)
markers = FindAllMarkers(merged_obj2,min.pct = 0.1 , logfc.threshold = 0.1)
write.csv(markers,file="AllMarkers.csv")
merged_obj2 <- JoinLayers(merged_obj2)
markers = FindAllMarkers(merged_obj2,min.pct = 0.1 , logfc.threshold = 0.1)
write.csv(markers,file="AllMarkers.csv")
# This code reorders the cluster identities in the Seurat object (merged_obj1) according to the specified order ("0", "1", "2", "3")
# تنظیم ترتیب خوشه‌ها به 0, 1, 2, 3
desired_order <- c("0", "1", "2", "3")
Idents(merged_obj1) <- factor(Idents(merged_obj1), levels = desired_order)
# تغییر نام خوشه‌ها به 0, 1, 2, 3
levels(merged_obj1) <- c("0", "1", "2", "3")
# کشیدن UMAP با ترتیب جدید خوشه‌ها
png(filename = "UMAP44.png", width = 10000, height = 4000, units ="px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
library(Seurat)
library(SeuratObject)
library(ggplot2)
library(rhdf5)
merged_obj1 = LoadSeuratRds(file="C:/Esmaeil/scRNA-seq/Backup of Local Data and Files Not on GitHub/Part 2/3_The Seurat object obtained after FindNeighbors and FindClusters/merged_obj1")
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "UMAP1.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
getwd()
png(filename = "FeaturePlot.png", width = 10000, height = 4000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD78A"))
dev.off()
saveRDS(file = "merged_obj1",merged_obj1)
# Remove clusters 1 2 3 6 8 9 10
merged_obj1 <- subset(merged_obj1, subset = seurat_clusters %in% c(1,2,3,6,8,9,10), invert = TRUE)
png(filename = "UMAP2.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# Remove cells with an x-axis value less than -2.
umap_coord <- merged_obj1@reductions[["umap"]]@cell.embeddings
cells_to_keep <- rownames(umap_coord[umap_coord[, "umap_1"] >= -2, ])
merged_obj1 <- subset(merged_obj1, cells = cells_to_keep)
png(filename = "UMAP3.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
saveRDS(file = "merged_obj1",merged_obj1)
merged_obj1$seurat_clusters <- recode(merged_obj1$seurat_clusters,
`0` = "1",
`4` = "2",
`5` = "3",
`7` = "4")
library(dplyr)
merged_obj1$seurat_clusters <- recode(merged_obj1$seurat_clusters,
`0` = "1",
`4` = "2",
`5` = "3",
`7` = "4")
png(filename = "UMAP4.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
library(Seurat)
library(SeuratObject)
library(ggplot2)
library(dplyr)
merged_obj1$seurat_clusters <- recode(merged_obj1$seurat_clusters,
`0` = "1",
`4` = "2",
`5` = "3",
`7` = "4")
png(filename = "UMAP4.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
merged_obj1$seurat_clusters <- recode(merged_obj1$seurat_clusters,
`0` = "1",
`4` = "2",
`5` = "3",
`7` = "4")
png(filename = "UMAP44.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
levels(merged_obj1$seurat_clusters) <- c("1", "2", "3", "4")
png(filename = "UMAP44.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
cluster_ids <- as.character(Idents(merged_obj1))
cluster_ids[cluster_ids == "4"] <- "1"
cluster_ids[cluster_ids == "5"] <- "2"
cluster_ids[cluster_ids == "7"] <- "3"
Idents(merged_obj1) <- cluster_ids
png(filename = "UMAP57.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
desired_order <- c("0", "1", "2", "3")
Idents(merged_obj1) <- factor(Idents(merged_obj1), levels = desired_order)
png(filename = "UMAP5.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 2")
library(Seurat)
library(SeuratObject)
library(ggplot2)
install.packages("BiocManager")
BiocManager::install("rhdf5")
merged_obj1 = LoadSeuratRds("C:/Esmaeil/irAEsProject/Backup/Part 2/4_The Seurat object obtained after UMAP and FeaturePlot/merged_obj1")
png(filename = "FeaturePlot1.png", width = 9000, height = 4000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD79A", "CD19"))
dev.off()
png(filename = "FeaturePlot1.png", width = 10000, height = 4000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD79A", "CD19"))
dev.off()
png(filename = "FeaturePlot1.png", width = 5000, height = 4000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD79A", "CD19"))
dev.off()
merged_obj1 = LoadSeuratRds("C:/Esmaeil/irAEsProject/Backup/Part6/3_The Seurat object obtained after First RunUMAP/merged_obj1")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 6")
merged_obj2 = merged_obj1
################################################################################ Start Merge selected clusters into a new group
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part4")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 6")
Idents(merged_obj2) <- "seurat_clusters"
all_clusters <- levels(Idents(merged_obj2))
cluster_colors <- setNames(rep("gray", length(all_clusters)), all_clusters)
#cluster_colors["0"] <- "blue"
#cluster_colors["12"] <- "red"
#cluster_colors["15"] <- "yellow"
cluster_colors["19"] <- "purple"
png(filename = "0_12_15.png", width = 8000, height = 4000, units = "px", res = 1200)
DimPlot(merged_obj2, reduction = "umap", cols = cluster_colors) +
ggtitle("UMAP") +
theme(
legend.text = element_text(size = 6),
legend.title = element_text(size = 8),
legend.key.size = unit(0.3, "cm")
)
dev.off()
png(filename = "FeaturePlot1.png", width = 14000, height = 9000, units = "px", res = 600)
FeaturePlot(merged_obj2, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD79A", "CD19"))
dev.off()
dim(merged_obj2)
# 1. تعداد سلول‌ها و ژن‌ها
dim(merged_obj2)
# خروجی مثل (genes × cells)
# 2. تعداد نمونه‌ها در دیتاست
table(merged_obj2$orig.ident)
# 3. تعداد کلاسترها
length(levels(Idents(merged_obj2)))
# 4. تعداد سلول در هر کلاستر
table(Idents(merged_obj2))
# 5. بررسی ادغام موفق (تعداد سلول از هر دیتاست در هر کلاستر)
table(merged_obj2$orig.ident, Idents(merged_obj2))
# 6. نمایش UMAP با رنگ‌بندی کلاستر
DimPlot(merged_obj2, reduction = "umap", label = TRUE, pt.size = 0.5) + ggtitle("Clusters after integration")
# 7. نمایش UMAP بر اساس dataset (برای بررسی batch correction)
DimPlot(merged_obj2, reduction = "umap", split.by = "orig.ident", pt.size = 0.4)
# 8. پیدا کردن ژن‌های مارکر هر کلاستر (Wilcoxon)
markers_wilcox <- FindAllMarkers(merged_obj2, only.pos = TRUE, min.pct = 0.1, logfc.threshold = 0.25)
# 9. پیدا کردن مارکر با MAST
if (!requireNamespace("MAST", quietly = TRUE)) BiocManager::install("MAST")
markers_mast <- FindAllMarkers(merged_obj2, only.pos = TRUE, test.use = "MAST", min.pct = 0.1, logfc.threshold = 0.25)
# 10. ذخیره خروجی‌ها برای استفاده در مقاله
write.csv(markers_wilcox, "markers_wilcox.csv", row.names = FALSE)
write.csv(markers_mast, "markers_mast.csv", row.names = FALSE)
# 11. مشاهده ژن‌های مارکر برتر برای هر کلاستر
top10 <- markers_wilcox %>% group_by(cluster) %>% top_n(n = 10, wt = avg_log2FC)
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 17),
legend.text = element_text(size = 25),
legend.title = element_text(size = 28),
legend.key.size = unit(2.5, "lines"),
override.aes = list(size = 10),
) +
guides(color = guide_legend(override.aes = list(size = 8)))
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 17)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 27)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 30)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 30),
legend.key.size = unit(2.5, "lines"),
override.aes = list(size = 10)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 40),
legend.key.size = unit(2.5, "lines"),
override.aes = list(size = 10)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 40),
legend.key.size = unit(2.5, "lines"),
override.aes = list(size = 13)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 40),
legend.key.size = unit(3, "lines"),
override.aes = list(size = 13)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 40),
legend.key.size = unit(5, "lines"),
override.aes = list(size = 13)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 40),
legend.key.size = unit(3, "lines"),
override.aes = list(size = 16)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
png(filename = "UMAP3.png",width = 20000,height=9000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "dataset") +
theme(
strip.text = element_text(size = 35),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 40),
legend.key.size = unit(3, "lines"),
override.aes = list(size = 26)
) +
guides(color = guide_legend(override.aes = list(size = 8)))
dev.off()
library(Seurat)
library(SeuratObject)
library(ggplot2)
library(dplyr)
library(openxlsx)
library(readxl)
library(future)
library(future.apply)
merged_obj1 = LoadSeuratRds("C:/Esmaeil/irAEsProject/Backup/Part6/3_The Seurat object obtained after First RunUMAP")
merged_obj1 = LoadSeuratRds("C:/Esmaeil/irAEsProject/Backup/Part6/3_The Seurat object obtained after First RunUMAP/merged_obj1")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 6")
merged_obj2 = merged_obj1
Idents(merged_obj2) <- "seurat_clusters"
all_clusters <- levels(Idents(merged_obj2))
cluster_colors <- setNames(rep("gray", length(all_clusters)), all_clusters)
p <- FeaturePlot(
merged_obj1,
features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD79A", "CD19")
)
# Customize legend text and key size
p <- p + theme(
legend.text = element_text(size = 20),   # Increase legend text size
legend.title = element_text(size = 22)   # Increase legend title size
) + guides(
color = guide_legend(override.aes = list(size = 6))  # Increase shape/point size in legend
)
# Save the plot
png(filename = "FeaturePlot1.png", width = 14000, height = 9000, units = "px", res = 600)
print(p)
dev.off()
# Customize legend text and key size
p <- p + theme(
legend.text = element_text(size = 30),
legend.title = element_text(size = 30)
) + guides(
color = guide_legend(override.aes = list(size = 6))
) + labs(
x = "",
y = ""
)
# Save the plot
png(filename = "FeaturePlot1.png", width = 14000, height = 9000, units = "px", res = 600)
print(p)
dev.off()
p <- FeaturePlot(
merged_obj1,
features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD79A", "CD19")
)
# Customize legend text and key size
p <- p + theme(
legend.text = element_text(size = 30),
legend.title = element_text(size = 30)
) + guides(
color = guide_legend(override.aes = list(size = 6))
) + labs(
x = "",
y = ""
)
# Save the plot
png(filename = "FeaturePlot1.png", width = 14000, height = 9000, units = "px", res = 600)
print(p)
dev.off()
library(Seurat)
library(SeuratObject)
library(ggplot2)
library(dplyr)
library(openxlsx)
library(readxl)
library(future)
library(future.apply)
library(MAST)
folder_path1 <- "C:/Esmaeil/irAEsProject/Backup/Part 1/3_The Seurat objects per sample"
rds_files1 <- list.files(folder_path1, pattern = "\\.rds$", full.names = TRUE)
for (i in seq_along(rds_files1)) {
obj <- readRDS(rds_files1[i])
assign(paste0("srob", i), obj)
}
################################################################################ End Load Seurat objects | Part 1
################################################################################ Start Load Seurat objects | Part 2
folder_path2 <- "C:/Esmaeil/irAEsProject/Backup/Part 2/5_The Seurat objects per sample"
rds_files2 <- list.files(folder_path2, pattern = "\\.rds$", full.names = TRUE)
offset2 <- length(rds_files1)
for (i in seq_along(rds_files2)) {
obj <- readRDS(rds_files2[i])
assign(paste0("srob", i + offset2), obj)
}
################################################################################ End Load Seurat objects | Part 2
################################################################################ Start Load Seurat objects | Part 3
folder_path3 <- "C:/Esmaeil/irAEsProject/Backup/Part 3/3_The Seurat objects per sample"
rds_files3 <- list.files(folder_path3, pattern = "\\.rds$", full.names = TRUE)
offset3 <- length(rds_files1) + length(rds_files2)
for (i in seq_along(rds_files3)) {
obj <- readRDS(rds_files3[i])
assign(paste0("srob", i + offset3), obj)
}
################################################################################ End Load Seurat objects | Part 3
################################################################################ Start Load Seurat objects | Part 4
folder_path4 <- "C:/Esmaeil/irAEsProject/Backup/Part 4/3_The Seurat objects per sample"
rds_files4 <- list.files(folder_path4, pattern = "\\.rds$", full.names = TRUE)
offset4 <- length(rds_files1) + length(rds_files2) + length(rds_files3)
for (i in seq_along(rds_files4)) {
obj <- readRDS(rds_files4[i])
assign(paste0("srob", i + offset4), obj)
}
merged_obj <- merge(srob1, y = list(srob2, srob3, srob4,srob5, srob6, srob7, srob8, srob9, srob10, srob11, srob12, srob13,
srob14, srob15, srob16, srob17, srob18, srob19, srob20, srob21, srob22, srob23, srob24, srob25,
srob26, srob27, srob28, srob29, srob30, srob31, srob32, srob33, srob34, srob35, srob36, srob37,
srob38, srob39, srob40, srob41, srob42, srob43, srob44, srob45, srob46, srob47, srob48, srob49,
srob50, srob51, srob52, srob53, srob54, srob55, srob56, srob57, srob58, srob59, srob60, srob61,
srob62, srob63, srob64, srob65, srob66, srob67, srob68, srob69, srob70, srob71, srob72, srob73,
srob74, srob75, srob76, srob77, srob78, srob79, srob80, srob81, srob82, srob83, srob84, srob85,
srob86, srob87, srob88, srob89, srob90, srob91, srob92, srob93, srob94, srob95, srob96, srob97))
