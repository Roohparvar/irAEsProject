library(Seurat)
library(SeuratObject)
library(ggplot2)
merged_obj1 = LoadSeuratRds(C:/Esmaeil/irAEsProject/Backup/Part 2/3_The Seurat object obtained after FindNeighbors and FindClusters/merged_obj1)
merged_obj1 = LoadSeuratRds("C:/Esmaeil/irAEsProject/Backup/Part 2/3_The Seurat object obtained after FindNeighbors and FindClusters/merged_obj1")
setwd("C:/Esmaeil/irAEsProject/irAEsProject/Part 2")
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "1_First UMAP.png", width = 4000,height = 3000, units ="px", res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
png(filename = "2_Feature Plot.png", width = 5000, height = 6000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c("CD3D", "CD3E", "CD3G", "LYZ", "CD79A", "CD19"))
dev.off()
png(filename = "2_Feature Plot.png", width = 5000, height = 6000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c(
"CD3D", "CD3E", "CD3G",  # T cell markers
"CD4",           # helper T cells
"CD8A", "CD8B",  # cytotoxic T cells
"TRAC", "TRBC1", "TRBC2",  # TCR chains
"IL7R", "TCF7", "SELL",    # naive/memory T cells
"MS4A1", "CD79A", "CD19",   # B cell markers
"LYZ", "CD14", "FCGR3A",   # Myeloid / Monocytes
"NCAM1", "KLRD1",   # NK cells
"HBB", "PPBP"   # Erythroid / Platelets
))
dev.off()
png(filename = "2_Feature Plot.png", width = 8000, height = 18000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c(
"CD3D", "CD3E", "CD3G",  # T cell markers
"CD4",           # helper T cells
"CD8A", "CD8B",  # cytotoxic T cells
"TRAC", "TRBC1", "TRBC2",  # TCR chains
"IL7R", "TCF7", "SELL",    # naive/memory T cells
"MS4A1", "CD79A", "CD19",   # B cell markers
"LYZ", "CD14", "FCGR3A",   # Myeloid / Monocytes
"NCAM1", "KLRD1",   # NK cells
"HBB", "PPBP"   # Erythroid / Platelets
))
dev.off()
png(filename = "2_Feature Plot.png", width = 10000, height = 30000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c(
"CD3D", "CD3E", "CD3G",  # T cell markers
"CD4",           # helper T cells
"CD8A", "CD8B",  # cytotoxic T cells
"TRAC", "TRBC1", "TRBC2",  # TCR chains
"IL7R", "TCF7", "SELL",    # naive/memory T cells
"MS4A1", "CD79A", "CD19",   # B cell markers
"LYZ", "CD14", "FCGR3A",   # Myeloid / Monocytes
"NCAM1", "KLRD1",   # NK cells
"HBB", "PPBP"   # Erythroid / Platelets
))
dev.off()
png(filename = "2_Feature Plot.png", width = 20000, height = 30000, units = "px", res = 600)
png(filename = "2_Feature Plot.png", width = 20000, height = 28000, units = "px", res = 600)
png(filename = "2_Feature Plot.png", width = 10000, height = 25000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c(
"CD3D", "CD3E", "CD3G",  # T cell markers
"CD4",           # helper T cells
"CD8A", "CD8B",  # cytotoxic T cells
"TRAC", "TRBC1", "TRBC2",  # TCR chains
"IL7R", "TCF7", "SELL",    # naive/memory T cells
"MS4A1", "CD79A", "CD19",   # B cell markers
"LYZ", "CD14", "FCGR3A",   # Myeloid / Monocytes
"NCAM1", "KLRD1",   # NK cells
"HBB", "PPBP"   # Erythroid / Platelets
))
dev.off()
png(filename = "2_Feature Plot.png", width = 15000, height = 25000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c(
"CD3D", "CD3E", "CD3G",  # T cell markers
"CD4",           # helper T cells
"CD8A", "CD8B",  # cytotoxic T cells
"TRAC", "TRBC1", "TRBC2",  # TCR chains
"IL7R", "TCF7", "SELL",    # naive/memory T cells
"MS4A1", "CD79A", "CD19",   # B cell markers
"LYZ", "CD14", "FCGR3A",   # Myeloid / Monocytes
"NCAM1", "KLRD1",   # NK cells
"HBB", "PPBP"   # Erythroid / Platelets
))
dev.off()
png(filename = "2_Feature Plot.png", width = 18000, height = 25000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c(
"CD3D", "CD3E", "CD3G",  # T cell markers
"CD4",           # helper T cells
"CD8A", "CD8B",  # cytotoxic T cells
"TRAC", "TRBC1", "TRBC2",  # TCR chains
"IL7R", "TCF7", "SELL",    # naive/memory T cells
"MS4A1", "CD79A", "CD19",   # B cell markers
"LYZ", "CD14", "FCGR3A",   # Myeloid / Monocytes
"NCAM1", "KLRD1",   # NK cells
"HBB", "PPBP"   # Erythroid / Platelets
))
dev.off()
merged_obj = LoadSeuratRds("C:/Esmaeil/irAEsProject/Backup/Part 2/2_The Seurat object obtained after IntegrateLayers/merged_obj")
merged_obj[["RNA"]] <- JoinLayers(merged_obj[["RNA"]])
library(Seurat)
library(SeuratObject)
library(ggplot2)
merged_obj = LoadSeuratRds("C:/Esmaeil/irAEsProject/Backup/Part 2/2_The Seurat object obtained after IntegrateLayers/merged_obj")
merged_obj[["RNA"]] <- JoinLayers(merged_obj[["RNA"]])
################################################################################ End integration
merged_obj1 = merged_obj
################################################################################ Start UMAP
merged_obj1 = FindNeighbors(merged_obj1, dims = 1:30, reduction = "integrated.cca")
merged_obj1 = FindClusters(merged_obj1, resolution = 0.4)
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "1_First UMAP.png", width = 4000,height = 3000, units ="px", res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
png(filename = "2_Feature Plot.png", width = 18000, height = 25000, units = "px", res = 600)
FeaturePlot(merged_obj1, features = c(
"CD3D", "CD3E", "CD3G",  # T cell markers
"CD4",           # helper T cells
"CD8A", "CD8B",  # cytotoxic T cells
"TRAC", "TRBC1", "TRBC2",  # TCR chains
"IL7R", "TCF7", "SELL",    # naive/memory T cells
"MS4A1", "CD79A", "CD19",   # B cell markers
"LYZ", "CD14", "FCGR3A",   # Myeloid / Monocytes
"NCAM1", "KLRD1",   # NK cells
"HBB", "PPBP"   # Erythroid / Platelets
))
dev.off()
merged_obj1 = merged_obj
################################################################################ Start UMAP
merged_obj1 = FindNeighbors(merged_obj1, dims = 1:30, reduction = "integrated.cca")
merged_obj1 = FindClusters(merged_obj1, resolution = 0.3)
# 3
# saveRDS(file = "merged_obj1",merged_obj1)
# The Seurat object obtained after FindNeighbors and FindClusters
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "1_First UMAP.png", width = 4000,height = 3000, units ="px", res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
